{% extends "pyggi/base.xhtml" %}
{% set repo = repository.name %}

{% block title %}{{ treeid }} in {{ repo }}{% endblock %}

{% block content %}

<!-- MENU -->
<div class="menu">
	<h1>actions</h1>
	<ul>
		<li><a href="{{ url_for('browse', repository=repo, tree=treeid) }}">browse tree</a></li>
	</ul>
{% if repository.branches %}
    <h1>branches ({{ repository.branches|length }})</h1>
    <ul>
    {% for branch in repository.branches %}
        <li><a href="{{ url_for('overview', repository=repo, tree=branch.name) }}">{{ branch.name }}</a></li>
    {% endfor %}
    </ul>
{% endif %}
{% if repository.tags %}
    <h1>tags ({{ repository.tags|length }})</h1>
    <ul>
    {% for tag in repository.tags %}
        <li><a href="{{ url_for('overview', repository=repo, tree=tag.name) }}">{{ tag.name }}</a></li>
    {% endfor %}
    </ul>
{% endif %}
</div>

<div class="content" style="margin-left: 150px">
    <!-- DESCRIPTION -->
    <h1>{{ repository.name }}</h1>
    <p class="description">{{ repository.description }}</p>
{% if repository.readme %}
    <p class="more"><a href="#readme">show readme</a></p>
{% endif %}

    <!-- LAST ACTIVITIES -->
    <h1>last activities</h1>
{% for commit in repository.last_activities(treeid) %}
    <div class="commit">
        <p class="date">{{ commit.committed_date|dateformat('%A %B %d %Y - %H:%M:%S') }}</p>
        <p class="author">{{ commit.author.name }} <b>committed</b> <a href="{{ url_for('commit', repository=repo, tree=commit.id) }}">{{ commit.id|truncate(8, True, '') }}</a></p>
        <p class="message">{{ commit.message }}</p>
    </div>
{% endfor %}

{% if repository.readme %}
    <!-- README -->
    <h1><a name="readme"></a>{{ repository.readme.name }}</h1>
    <div class="readme wikistyle">
    {% if repository.readme.type == "plain" %}
        <div class="pre">{{ repository.readme.data|safe }}</div>
    {% else %}
        {{ repository.readme.data|safe }}
    {% endif %}
    </div>
{% endif %}
</div>

{% endblock %}
