{% extends "base.xhtml" %}
{% set repo = repository.name %}

{% block title %}{{ treeid }} in {{ repo }}{% endblock %}

{% block content %}

<!-- MENU -->
<div class="menu">
	<h1>actions</h1>
	<ul>
	    <li><a href="{{ url_for('.overview', repository=repo, tree=treeid) }}">overview</a></li>
		<li><a href="{{ url_for('.browse', repository=repo, tree=treeid) }}">browse tree</a></li>
		<li><a href="{{ url_for('.shortlog', repository=repo, tree=treeid) }}">shortlog</a></li>
		<li><a href="{{ url_for('.download', repository=repo, tree=treeid) }}">tarball</a></li>
	</ul>
{% if repository.branches %}
    <h1>branches ({{ repository.branches|length }})</h1>
    <ul>
    {% for branch in repository.branches %}
        <li><a href="{{ url_for('.overview', repository=repo, tree=branch.name) }}">{{ branch.name }}</a></li>
    {% endfor %}
    </ul>
{% endif %}
{% if repository.tags %}
    <h1>tags ({{ repository.tags|length }})</h1>
    <ul>
    {% for tag in repository.tags %}
        <li><a href="{{ url_for('.overview', repository=repo, tree=tag.name) }}">{{ tag.name }}</a></li>
    {% endfor %}
    </ul>
{% endif %}
</div>

<div class="content" style="margin-left: 150px">
    <!-- SHORTLOG -->
    <h1>shortlog</h1>
	<table cellspacing="0" cellpadding="0" width="100%" class="history">
{% set skip=page*10 %}
{% for item in repository.last_activities(treeid, 10, skip) %}
		<tr>
			<td class="commit {{ loop.cycle('odd','even') }}"><code><a href="{{ url_for('.commit', repository=repo, tree=item.id) }}">{{ item.id|truncate(8, true, '') }}</a></code></td>
			<td class="author {{ loop.cycle('odd','even') }}" nowrap><b>{{ item.author.name|force_unicode }}</b><br/>{{ item.committed_date|timesince }}</td>
			<td class="message {{ loop.cycle('odd','even') }}">
	{% for branch in repository.branches %}
		{% if branch.commit.id == item.id %}
				<span class="note">{{ branch.name }}</span>
		{% endif %}
	{% endfor %}
	{% for tag in repository.tags %}
		{% if tag.commit.id == item.id %}
				<span class="note">{{ tag.name }}</span>
		{% endif %}
	{% endfor %}
				{{ item.message|force_unicode }}
			</td>
		</tr>
{% endfor %}
	</table>

	<table width="100%" cellspacing="0" cellpadding="0" border="0" style="margin-top: 15px;">
		<tr>
			<td width="50%" style="text-align: left;">
{% if page < max_pages %}
				<a href="{{ url_for('.shortlog', repository=repo, tree=treeid) }}?p={{ page+1 }}">&laquo; older entries</a>&nbsp;
{% endif %}
			</td>
			<td width="50%" style="text-align: right;">
{% if page > 0 %}
				<a href="{{ url_for('.shortlog', repository=repo, tree=treeid) }}?p={{ page-1 }}">newer entries &raquo;</a>&nbsp;
{% endif %}
			</td>
		</tr>
	</table>
</div>

{% endblock %}
